<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sallama Dedektifi V15.0 (FULL BUTON)</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f0f0;
            color: #333;
            padding: 30px;
        }
        .container {
            max-width: 700px;
            margin: auto;
            background: #ffffff;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #e74c4c;
            text-align: center;
            border-bottom: 3px solid #e74c4c;
            padding-bottom: 10px;
            margin-bottom: 25px;
        }
        #diyalogAlani {
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background-color: #fcf8e3;
            min-height: 150px;
        }
        .soru-metni {
            font-size: 1.1em;
            font-weight: bold;
            color: #34495e;
            margin-bottom: 15px;
        }
        .secenek-butonu, .cevap-btn {
            padding: 10px 20px;
            margin: 5px;
            border-radius: 5px;
            border: 2px solid #3498db;
            background-color: #f2faff;
            color: #3498db;
            cursor: pointer;
            transition: background-color 0.2s, color 0.2s;
            font-weight: bold;
        }
        .cevap-btn {
            border: 2px solid #9b59b6;
            background-color: #9b59b6;
            color: white;
            margin-top: 15px;
        }
        .secenek-butonu:hover {
            background-color: #3498db;
            color: white;
        }
        .secenek-butonu.active {
            background-color: #e74c4c;
            color: white;
            border-color: #c0392b;
        }
        #sonucAlani {
            margin-top: 25px;
            padding: 20px;
            border: 2px solid #2ecc71;
            border-radius: 8px;
            background-color: #e8f8f5;
        }
        .analiz-baslik {
            color: #34495e;
            font-weight: bold;
            margin-top: 10px;
        }
        #telifHakk覺 {
            margin-top: 20px;
            text-align: center;
            font-size: 0.8em;
            color: #7f8c8d;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1> Eggapps | Sallama Dedektifi: ULTRA SRM (V1.5.0)</h1>
        
        <div id="diyalogAlani">
            <div class="soru-metni" id="soruMetni"></div>
            <div id="cevapSecenekleri"></div>
        </div>

        <div id="sonucAlani" style="display:none;">
            <h2>Dedektif Tahmini</h2>
            <p><strong>En Olas覺 Cevap:</strong> <span id="tahminSik"></span></p>
            <p class="analiz-baslik">Kullan覺lan Kurallar ve Analiz:</p>
            <ul id="analizListesi"></ul>
            <button class="cevap-btn" onclick="baslat()">Yeniden Bala</button>
        </div>
        
        <div id="telifHakk覺">
            &copy; 2025 Eggapps Telif Hakk覺. T羹m haklar覺 sakl覺d覺r.
        </div>
    </div>

    <script>
        let state = 0;
        let secimler = {};
        const Harfler = ["A", "B", "C", "D", "E"];
        
        const sorular = [
            // 0: 覺k Say覺s覺 (BUTON)
            { id: 0, soru: "Soru ka癟 覺kl覺?", sonraki: 1, key: 'sik_sayisi', tip: 'tek', secenekler: [{text: "4 覺k (A-B-C-D)", value: 4}, {text: "5 覺k (A-B-C-D-E)", value: 5}] },
            
            // 1: 覺k Tipi (BUTON)
            { id: 1, soru: "覺klar say覺sal m覺 yoksa metin mi i癟eriyor?", sonraki: 2, key: 'tip', tip: 'tek', secenekler: [{text: "Say覺sal", value: "SAYISAL"}, {text: "Metin", value: "MET襤N"}] },
            
            // 2: U癟 Eleme (BUTON)
            { id: 2, soru: "Say覺sal 覺klarda, en k羹癟羹k ve en b羹y羹k 覺k aras覺nda 癟ok b羹y羹k bir fark var m覺?", sonraki: 21, key: 'uc_eleme_var', tip: 'tek', secenekler: [{text: "Evet, var", value: "EVET"}, {text: "Hay覺r, yok", value: "HAYIR"}] },
            
            // 21: U癟 Olmayanlar (OKLU IK BUTON)
            { id: 21, soru: "U癟 deer tuza覺 varsa: Hangi 覺klar u癟 deer **DE襤LD襤R** (ortada kalm覺t覺r)?", sonraki: 3, key: 'uc_olmayan_sik', tip: 'coklu_sik' },

            // 3: Nadir Kelimeler/Yuvarlak Say覺lar (BUTON)
            { id: 3, soru: "覺klardan biri '9.81' gibi teknik bir say覺 i癟erirken, dieri '10' gibi yuvarlak bir say覺 i癟eriyor mu?", sonraki: 31, key: 'teknik_sayi_var', tip: 'tek', secenekler: [{text: "Evet, i癟eriyor", value: "EVET"}, {text: "Hay覺r, i癟ermiyor", value: "HAYIR"}] }, 
            
            // 31: Teknik Say覺 Hangi 覺kta? (TEK IK BUTON)
            { id: 31, soru: "Hangi 覺k k羹suratl覺 teknik say覺y覺 i癟eriyor?", sonraki: 4, key: 'teknik_sayi_sik', tip: 'tek_sik' },

            // 4: Hepsi/T羹m羹 Kural覺 (BUTON)
            { id: 4, soru: "覺klardan biri 'Hepsi', 'T羹m羹' gibi kapsay覺c覺 ifadeler i癟eriyor mu?", sonraki: 5, key: 'hepsi_tumu_var', tip: 'tek', secenekler: [{text: "Evet, i癟eriyor", value: "EVET"}, {text: "Hay覺r, i癟ermiyor", value: "HAYIR"}] },
            
            // 5: Hangi 覺k Hepsi/T羹m羹 襤癟eriyor? (TEK IK BUTON)
            { id: 5, soru: "Hangi 覺k, 'Hepsi/T羹m羹' ifadesini i癟eriyor?", sonraki: 6, key: 'hepsi_tumu_sik', tip: 'tek_sik' },
            
            // 6: A覺r覺 Genelleme/K覺s覺tlama (OKLU IK BUTON)
            { id: 6, soru: "Hangi 覺klar 'yaln覺zca', 'mutlak', 'tek nedeni' gibi 癟ok k覺s覺tlay覺c覺 kelimeler i癟eriyor?", sonraki: 7, key: 'kisitlayici', tip: 'coklu_sik_hicbiri' },

            // 7: eliki Kural覺 (OKLU IK BUTON)
            { id: 7, soru: "Hangi ikisi birbirine tamamen z覺t ve 癟elien ifade i癟eriyor?", sonraki: 8, key: 'celiski', tip: 'ikili_sik_hicbiri' },

            // 8: Destek Tuza覺 Kural覺 (OKLU IK BUTON)
            { id: 8, soru: "Hangi iki 覺k ayn覺 fikri farkl覺 kelimelerle destekliyor?", sonraki: 9, key: 'destek', tip: 'ikili_sik_hicbiri' },

            // 9: ifte 襤sim Tuza覺 (BUTON)
            { id: 9, soru: "覺klardan biri '襤ki olay覺/kiiyi' ayn覺 anda i癟eriyor mu?", sonraki: 11, key: 'cifte_isim', tip: 'tek', secenekler: [{text: "Evet, i癟eriyor", value: "EVET"}, {text: "Hay覺r, i癟ermiyor", value: "HAYIR"}] }
        ];
        
        const soruMap = {};
        sorular.forEach(s => soruMap[s.id] = s);
        
        // Dinamik olarak se癟ilen 覺klar覺 tutmak i癟in
        let anlikSecilenSiklar = [];

        // --- GSTER襤M VE 襤LERLEME FONKS襤YONLARI ---

        function gosterSoru(id) {
            state = id;
            anlikSecilenSiklar = []; // Yeni soruya ge癟erken se癟ilenleri s覺f覺rla
            
            if (id === 11) { finalTahmin(); return; } 
            
            const s = soruMap[id];
            
            // --- AKI KONTROL ---
            if (secimler.tip === "MET襤N" && (id >= 2 && id <= 31)) { gosterSoru(4); return; } 
            if (secimler.uc_eleme_var === "HAYIR" && id === 21) { gosterSoru(3); return; }
            if (secimler.teknik_sayi_var === "HAYIR" && id === 31) { gosterSoru(4); return; }
            if (secimler.hepsi_tumu_var === "HAYIR" && id === 5) { gosterSoru(6); return; }
            
            if (!s) { return; } 

            document.getElementById('soruMetni').textContent = s.soru;
            const cevapSecenekleri = document.getElementById('cevapSecenekleri');
            cevapSecenekleri.innerHTML = '';
            
            if (s.tip === 'tek') {
                // Soru 0, 1, 2, 3, 4, 9 gibi tek cevapl覺 sorular
                s.secenekler.forEach(secenek => {
                    const btn = document.createElement('button');
                    btn.className = 'secenek-butonu';
                    btn.textContent = secenek.text;
                    btn.onclick = () => cevaplaTekli(secenek.value, s.key, s.sonraki);
                    cevapSecenekleri.appendChild(btn);
                });
            } 
            else if (s.tip === 'tek_sik') {
                // Soru 31, 5 gibi tek 覺k cevapl覺 sorular (A, B, C...)
                gosterSikButonlari(s.key, s.sonraki, 'tek');
            }
            else if (s.tip === 'coklu_sik' || s.tip === 'ikili_sik_hicbiri' || s.tip === 'coklu_sik_hicbiri') {
                // Soru 21, 6, 7, 8 gibi 癟oklu veya ikili 覺k cevapl覺 sorular
                gosterSikButonlari(s.key, s.sonraki, s.tip === 'ikili_sik_hicbiri' ? 'ikili' : 'coklu');
            }
        }
        
        // --- BUTON TIKLAMA FONKS襤YONLARI ---

        function cevaplaTekli(cevap, key, sonraki) {
            secimler[key] = cevap;
            gosterSoru(sonraki);
        }

        function gosterSikButonlari(key, sonraki, tip) {
            const sikSayisi = secimler.sik_sayisi;
            const HarfSecenekleri = Harfler.slice(0, sikSayisi);
            const cevapSecenekleri = document.getElementById('cevapSecenekleri');
            
            // 覺k butonlar覺n覺 olutur
            HarfSecenekleri.forEach(harf => {
                const btn = document.createElement('button');
                btn.className = 'secenek-butonu sik-butonu';
                btn.id = 'btn-' + harf;
                btn.textContent = harf;
                btn.onclick = () => sikButonuTiklandi(harf, tip);
                cevapSecenekleri.appendChild(btn);
            });

            // Gerekliyse "H襤B襤R襤" butonu ekle
            if (tip === 'coklu' || tip === 'ikili' || tip === 'coklu_sik_hicbiri' || tip === 'ikili_sik_hicbiri') {
                 const hicbiriBtn = document.createElement('button');
                 hicbiriBtn.className = 'secenek-butonu sik-butonu';
                 hicbiriBtn.id = 'btn-HICBIRI';
                 hicbiriBtn.textContent = 'H襤B襤R襤';
                 hicbiriBtn.onclick = () => sikButonuTiklandi('H襤B襤R襤', tip);
                 cevapSecenekleri.appendChild(hicbiriBtn);
            }
            
            // Onay butonu ekle
            const onayBtn = document.createElement('button');
            onayBtn.className = 'cevap-btn';
            onayBtn.textContent = (tip === 'tek') ? "Devam Et" : "Onayla ve 襤lerle";
            onayBtn.disabled = (tip !== 'tek'); // Tek 覺k deilse bata devre d覺覺
            onayBtn.id = 'onay-btn';
            onayBtn.onclick = () => cevaplaCokluSik(key, sonraki, tip);
            cevapSecenekleri.appendChild(onayBtn);
            
            // Tek 覺k tipinde 繹nceden se癟ilen 覺k varsa onay butonunu etkinletir
            if (tip === 'tek') {
                anlikSecilenSiklar = []; // Tek 覺k modunda s覺f覺rla
            }
        }

        function sikButonuTiklandi(harf, tip) {
            const btn = document.getElementById('btn-' + harf);
            const onayBtn = document.getElementById('onay-btn');
            
            // Tek 覺k Modu (A, B, C, D)
            if (tip === 'tek') {
                document.querySelectorAll('.sik-butonu').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                anlikSecilenSiklar = [harf];
                onayBtn.disabled = false;
            } 
            // oklu 覺k Modu (oklu veya 襤kili 覺klar)
            else {
                // H襤B襤R襤 se癟ildiyse, dier t羹m se癟imleri s覺f覺rla
                if (harf === 'H襤B襤R襤') {
                    document.querySelectorAll('.sik-butonu').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    anlikSecilenSiklar = ['H襤B襤R襤'];
                } else {
                    // Dier 覺klar se癟ilirse H襤B襤R襤'ni deaktif et
                    const hicbiriBtn = document.getElementById('btn-HICBIRI');
                    if(hicbiriBtn) hicbiriBtn.classList.remove('active');

                    if (btn.classList.contains('active')) {
                        btn.classList.remove('active');
                        anlikSecilenSiklar = anlikSecilenSiklar.filter(s => s !== harf);
                    } else {
                        // 襤kili 覺k kural覺 (Soru 7 ve 8)
                        if (tip.startsWith('ikili') && anlikSecilenSiklar.length >= 2) {
                            alert("Bu soru i癟in sadece iki 覺k se癟ebilirsiniz.");
                            return;
                        }
                        btn.classList.add('active');
                        anlikSecilenSiklar.push(harf);
                    }
                    anlikSecilenSiklar = anlikSecilenSiklar.filter(s => s !== 'H襤B襤R襤'); // H襤B襤R襤'yi 癟覺kar
                }
                
                // Onay butonunu etkinletirme
                if (tip.startsWith('ikili')) {
                    // 襤kili modda, 2 覺k veya H襤B襤R襤 se癟iliyse
                    onayBtn.disabled = !(anlikSecilenSiklar.length === 2 || anlikSecilenSiklar[0] === 'H襤B襤R襤');
                } else {
                    // oklu modda, 1 veya daha fazla 覺k veya H襤B襤R襤 se癟iliyse
                    onayBtn.disabled = anlikSecilenSiklar.length === 0;
                }
            }
        }

        function cevaplaCokluSik(key, sonraki, tip) {
            let cevapStr = '';
            
            if (anlikSecilenSiklar[0] === 'H襤B襤R襤' || anlikSecilenSiklar.length === 0) {
                 cevapStr = 'H襤B襤R襤';
            } 
            else if (tip === 'tek_sik') {
                 cevapStr = anlikSecilenSiklar[0]; // Tek 覺k i癟in sadece harf
            }
            else if (tip.startsWith('ikili')) {
                // 襤kili 覺k (eliki, Destek) format覺 "A VE E"
                if (anlikSecilenSiklar.length === 2) {
                    cevapStr = anlikSecilenSiklar[0] + " VE " + anlikSecilenSiklar[1];
                } else {
                    alert("Bu soru i癟in iki 覺k se癟melisiniz."); return;
                }
            }
            else {
                // oklu 覺k format覺 (Virg羹lle ayr覺lm覺)
                cevapStr = anlikSecilenSiklar.join(', ');
            }

            secimler[key] = cevapStr;
            gosterSoru(sonraki);
        }
        
        // --- F襤NAL TAHM襤N FONKS襤YONU ---

        function finalTahmin() {
            const sikSayisi = secimler.sik_sayisi;
            if (!sikSayisi) { alert("覺k say覺s覺 bilgisi al覺namad覺. L羹tfen yeniden balay覺n."); return; }
            const HarfSecenekleri = Harfler.slice(0, sikSayisi);
            let tahminPuani = new Array(sikSayisi).fill(0);
            let analizler = [];

            // 1. 襤STAT襤ST襤KSEL MERKEZ E襤L襤M襤
            if (sikSayisi === 4) {
                tahminPuani[1] += 3; tahminPuani[2] += 5; 
                analizler.push("Merkez Eilimi: B 覺kk覺na (+3), C 覺kk覺na (+5) puan verildi.");
            } else if (sikSayisi === 5) {
                tahminPuani[1] += 3; tahminPuani[2] += 5; tahminPuani[3] += 3; 
                analizler.push("Merkez Eilimi: C 覺kk覺 (+5), B ve D 覺klar覺 (+3) puan ald覺.");
            }
            
            // --- 2. KULLANILAN KURALLARA GRE PUANLAMA ---
            
            // 2.7. U癟 Eleme Kural覺 (Soru 2 ve 21)
            if (secimler.tip === "SAYISAL" && secimler.uc_eleme_var === "EVET" && secimler.uc_olmayan_sik) {
                 const ucOlmayanCevap = secimler.uc_olmayan_sik; 
                 const ucOlmayanHarfler = ucOlmayanCevap.split(/ VE |, /).map(h => h.trim());
                 
                 ucOlmayanHarfler.forEach(harf => {
                    const harfIndex = HarfSecenekleri.indexOf(harf);
                    if (harfIndex !== -1) {
                        tahminPuani[harfIndex] += 5; 
                        analizler.push("U癟 Eleme Kural覺: 覺k " + harf + " (Ortada kald覺覺 i癟in) (+5) puan ald覺.");
                    }
                 });
            }
            
            // 2.6. Nadir Kelimeler Kural覺 (Soru 3 ve 31)
            if (secimler.tip === "SAYISAL" && secimler.teknik_sayi_var === "EVET" && secimler.teknik_sayi_sik) {
                 const teknikHarf = secimler.teknik_sayi_sik;
                 const teknikIndex = HarfSecenekleri.indexOf(teknikHarf);
                 if (teknikIndex !== -1) {
                     tahminPuani[teknikIndex] += 8;
                     analizler.push("Nadir Kelimeler (Say覺sal): Teknik say覺 i癟eren 覺k (" + teknikHarf + ") (+8) puan ald覺.");
                 }
            }


            // Dier Kural Uygulamalar覺 (Deimedi)
            // Hepsi/T羹m羹 Kural覺 (2.1)
            if (secimler.hepsi_tumu_var === "EVET" && secimler.hepsi_tumu_sik) {
                const kapsayiciHarf = secimler.hepsi_tumu_sik;
                const kapsayiciIndex = HarfSecenekleri.indexOf(kapsayiciHarf);
                if (kapsayiciIndex !== -1) {
                    tahminPuani[kapsayiciIndex] += 15;
                    analizler.push("Hepsi/T羹m羹 Kural覺: 覺k " + kapsayiciHarf + " (+15) puan ald覺.");
                }
            }

            // A覺r覺 Genelleme Elemesi (2.2)
            const kesinlikCevabi = secimler.kisitlayici; 
            if (kesinlikCevabi && kesinlikCevabi !== "H襤B襤R襤") {
                const kesinlikHarfleri = kesinlikCevabi.split(',').map(h => h.trim());
                kesinlikHarfleri.forEach(harf => {
                    const kesinlikIndex = HarfSecenekleri.indexOf(harf);
                    if (kesinlikIndex !== -1) {
                        tahminPuani[kesinlikIndex] -= 10; 
                        analizler.push("A覺r覺 Genelleme Elemesi: 覺k " + harf + " (Mutlak ifade i癟erdii i癟in) (-10) puan kaybetti.");
                    }
                });
            }

            // eliki Kural覺 (2.3)
            const celiskiCevabi = secimler.celiski; 
            if (celiskiCevabi && celiskiCevabi !== "H襤B襤R襤") {
                const harfler = celiskiCevabi.split('VE').map(h => h.trim()); 
                const index1 = HarfSecenekleri.indexOf(harfler[0].trim());
                const index2 = HarfSecenekleri.indexOf(harfler[1].trim());
                if (index1 !== -1 && index2 !== -1) {
                    tahminPuani[index1] += 10;
                    tahminPuani[index2] += 10;
                    analizler.push("eliki Kural覺: " + harfler[0].trim() + " ve " + harfler[1].trim() + " 覺klar覺 birbirini 癟羹r羹tt羹羹 i癟in (+10) puan ald覺.");
                }
            }
            
            // Destek Tuza覺 Kural覺 (2.4)
            const destekCevabi = secimler.destek; 
            if (destekCevabi && destekCevabi !== "H襤B襤R襤") {
                const harfler = destekCevabi.split('VE').map(h => h.trim()); 
                const index1 = HarfSecenekleri.indexOf(harfler[0].trim());
                const index2 = HarfSecenekleri.indexOf(harfler[1].trim());
                if (index1 !== -1 && index2 !== -1) {
                    tahminPuani[index1] -= 5; 
                    tahminPuani[index2] -= 5;
                    analizler.push("Destek Tuza覺 Kural覺: " + harfler[0].trim() + " ve " + harfler[1].trim() + " 覺klar覺 birbirini destekledii i癟in (-5) puan kaybetti.");
                }
            }

            // ifte 襤sim Tuza覺 (2.5)
            if (secimler.cifte_isim === "EVET") {
                 if (sikSayisi >= 3) {
                     tahminPuani[1] += 5; tahminPuani[2] += 5; 
                     analizler.push("ifte 襤sim Tuza覺: B ve C 覺klar覺na (+5) puan verildi.");
                 }
            }


            // 3. SONU HESAPLAMA
            let maxPuan = -Infinity;
            let esitPuanlar = [];
            
            tahminPuani.forEach((puan, index) => {
                if (puan > maxPuan) {
                    maxPuan = puan;
                    esitPuanlar = [HarfSecenekleri[index]];
                } else if (puan === maxPuan && maxPuan !== -Infinity) {
                    esitPuanlar.push(HarfSecenekleri[index]);
                }
            });

            let tahminSik = (esitPuanlar.length > 1) ? esitPuanlar.join(" ve ") + " (Eitlik)" : esitPuanlar[0];

            // Sonucu g繹sterme
            document.getElementById('tahminSik').textContent = tahminSik + " (Puan: " + maxPuan + ")";
            
            const analizListesi = document.getElementById('analizListesi');
            analizListesi.innerHTML = '';
            
            // Puan Tablosu Ekle
            let puanTablosu = 'Puan Durumu: ';
            HarfSecenekleri.forEach((harf, index) => {
                puanTablosu += `${harf}: ${tahminPuani[index]}, `;
            });
            analizler.push(puanTablosu.slice(0, -2));

            analizler.forEach(a => {
                const li = document.createElement('li');
                li.textContent = a;
                analizListesi.appendChild(li);
            });
            
            if (analizler.length === 1 && analizler[0].startsWith('Puan Durumu')) { 
                 analizListesi.innerHTML = "<li>Yeterli ipucu edinilemedii i癟in sadece Merkez Eilimi Kural覺 uyguland覺.</li>" + analizListesi.innerHTML;
            }

            document.getElementById('diyalogAlani').style.display = 'none';
            document.getElementById('sonucAlani').style.display = 'block';
        }

        function baslat() {
            secimler = {};
            document.getElementById('diyalogAlani').style.display = 'block';
            document.getElementById('sonucAlani').style.display = 'none';
            gosterSoru(0);
        }

        window.onload = baslat;
    </script>

</body>
</html>
